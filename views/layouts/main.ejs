
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/css/style-main.css">
   
    <title><%= title %></title>
</head>
<body>
    <script src="/socket.io/socket.io.js"></script>
    <script src="/js/baseFunctions.js"></script>
    <script>
    
    const socket = io();

    // Nachricht vom Server empfangen
    function showAndAutoHide(id, text, ms) {
        const el = document.getElementById(id);
        el.querySelector('p').innerText = text;
        el.style.display = 'block';
        el.classList.remove('fade-out');

        // Fortschrittsbalken starten: 체ber style.animationDuration
        el.style.setProperty('--progress-time', ms + 'ms');
        el.style.setProperty('position', 'fixed'); // wichtig, damit ::after positioniert

        // direkt CSS-Animation zuweisen
        el.style.setProperty('animation', 'toast-pop-in 240ms cubic-bezier(.2,.8,.2,1)');
        el.style.setProperty('--progress-anim', 'toast-progress ' + ms + 'ms linear forwards');
        el.querySelector('p').style.marginBottom = '6px'; // bisschen Platz f체r Balken
        el.style.setProperty('overflow', 'hidden');

        // Balken tats채chlich animieren
        el.classList.add('with-progress');
        el.style.setProperty('--progress-anim', 'toast-progress ' + ms + 'ms linear forwards');

        el.style.setProperty('--progress-anim', 'toast-progress ' + ms + 'ms linear forwards');
        el.style.setProperty('--progress-time', ms + 'ms');
        el.style.setProperty('--progress', 'running');

        el.style.setProperty('--progress-anim', 'toast-progress ' + ms + 'ms linear forwards');
        el.style.setProperty('--progress-time', ms + 'ms');
        el.style.setProperty('--progress', 'running');

        // 체ber Inline-Style Animation auf ::after setzen
        el.style.setProperty('--progress-anim', 'toast-progress ' + ms + 'ms linear forwards');
        el.style.setProperty('--progress-time', ms + 'ms');

        el.style.setProperty('--progress', 'running');
        el.style.setProperty('--progress-anim', 'toast-progress ' + ms + 'ms linear forwards');
        el.style.setProperty('--progress-time', ms + 'ms');

        el.style.setProperty('--progress', 'running');
        el.style.setProperty('--progress-anim', 'toast-progress ' + ms + 'ms linear forwards');
        el.style.setProperty('--progress-time', ms + 'ms');

        el.style.setProperty('--progress', 'running');
        el.style.setProperty('--progress-anim', 'toast-progress ' + ms + 'ms linear forwards');
        el.style.setProperty('--progress-time', ms + 'ms');

        el.style.setProperty('--progress', 'running');

        // Auto ausblenden nach Zeit
        setTimeout(() => {
            el.classList.add('fade-out');
            setTimeout(() => {
            el.style.display = 'none';
            el.classList.remove('fade-out', 'with-progress');
            el.querySelector('p').innerText = '';
            el.style.removeProperty('--progress-anim');
            }, 200);
        }, ms);
    }

    socket.on('backend_error', (msg) => {
        console.error('[SOCKETIO] Backend-Fehler:', msg);
        showAndAutoHide('error-div', `Error-Message: ${msg.message}, Error-code: ${msg.code}, Thrown by backend`, 7000);
    });
    socket.on('backend_online', () => {
        showAndAutoHide('message-div', 'UwU UwU UwU UwU UwU UwU UwU', 2000);
    });
    socket.on('backend_offline', () => {
        showAndAutoHide('warning-div', 'Backend is offline', 2000);
    });

    </script>

    <div class="error" id="error-div"><p id="current_error"></p></div>
    <div class="warning" id="warning-div"><p id="current_warning"></p></div>
    <div class="message" id="message-div"><p id="current_message"></p></div>
    <%- body %>
    <script src="/js/socketio_base_com.js"></script>
</body>
</html>